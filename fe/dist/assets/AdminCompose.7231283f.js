import{r as e,g as a,_ as r,a as t}from"./index.0ba24a74.js";import{_ as s}from"./CMdEditor.vue_vue&type=style&index=0&lang.4b2e7d97.js";import{d as n,a as c,r as l,c as p}from"./vendor.dcc053a3.js";const o=[{reg:/(_{1,2}|\*{1,2}|~{1,2})(.{1,20})\1/g,replace:(e,a,r)=>r},{reg:/^#{1,6}/gm,replace:()=>""},{reg:/^> (.*)/gm,replace:(e,a)=>a},{reg:/```[\s\S]*?```/gm,replace:()=>"[代码]"},{reg:/`.*?`/g,replace:()=>"[代码]"},{reg:/!\[(.*)\]\(.*\)(\{{3,3}.*\}{3,3})?/g,replace:(e,a)=>`[图片：${a}]`},{reg:/\[(.*)\]\(.*\)/g,replace:(e,a)=>`[链接：${a}]`},{reg:/\$.*\$/g,replace:()=>"[公式]"},{reg:/\$\$(.|\n)*?\$\$/gm,replace:()=>"[公式]"},{reg:/\s+/gm,replace:()=>" "}];var m=n({name:"AdminCompose",setup(n){const m=c(""),g=c([]);a().then((e=>g.value=e));const u=l(new Set);async function i(){const[a,r,t]=/# (.*)\n([\s\S]*)/gm.exec(m.value)||[];if(!r)return alert("没有标题");if(!t)return alert("没有主要内容");const s=function(e){return o.reduce(((e,a)=>e.replace(a.reg,a.replace)),e).slice(0,200)}(t);await async function(a){return!!(await e({method:"POST",data:a,url:"/post"})).data}({digest:s,title:r,content:m.value,tagNames:[...u]})?alert("发布成功!"):alert("出错了!")}return()=>p("div",{class:"pa-compose"},[p("div",{class:"pa-compose_wrapper"},[p(s,{content:m},null),p("div",{class:"pa-compose_wrapper-tags"},[g.value.map((e=>p(r,{class:"pa-compose_wrapper-tags-tag",name:e.name,key:e._id,active:u.has(e.name),onClick:()=>u.has(e.name)?u.delete(e.name):u.add(e.name)},null))),p(r,{class:"pa-compose_wrapper-tags-tag",name:"添加+",onClick:()=>{const e=prompt("输入新标签的名字：");e&&(g.value=[...g.value,{name:e,_id:"new"+g.value.length,count:0}])}},null)])]),p(t,{class:"pa-compose_upload",onClick:i,content:"上传"},null)])}});export{m as default};
