import{r as a,g as e,a as s,b as t,c as n,_ as o}from"./index.213a0884.js";import{_ as l}from"./CMdEditor.vue_vue&type=style&index=0&lang.1369e636.js";import{g as r}from"./generateDigest.d8cbf049.js";import{d as p,a as c,o as m,r as i,c as d}from"./vendor.352936e6.js";var u=p({name:"AdminCompose",setup(p){const u=c(""),g=c([]);e().then((a=>g.value=a)),m((()=>{s()||t.push({name:"admin-login"}).then((()=>alert("请先登录!")))}));const v=i(new Set);async function f(){const[e,s,t]=/# (.*)\n([\s\S]*)/gm.exec(u.value)||[];if(!s)return alert("没有标题");if(!t)return alert("没有主要内容");const n=r(t);await async function(e){return!!(await a({method:"POST",data:e,url:"/post"})).data}({digest:n,title:s,content:u.value,tagNames:[...v]})?alert("发布成功!"):alert("出错了!")}return()=>d("div",{class:"pa-compose"},[d("div",{class:"pa-compose_wrapper"},[d(l,{content:u},null),d("div",{class:"pa-compose_wrapper-tags"},[g.value.map((a=>d(n,{class:"pa-compose_wrapper-tags-tag",name:a.name,key:a._id,active:v.has(a.name),onClick:()=>v.has(a.name)?v.delete(a.name):v.add(a.name)},null))),d(n,{class:"pa-compose_wrapper-tags-tag",name:"添加+",onClick:()=>{const a=prompt("输入新标签的名字：");a&&(g.value=[...g.value,{name:a,_id:"new"+g.value.length,count:0}],v.add(a))}},null)])]),d(o,{class:"pa-compose_upload",onClick:f,content:"上传"},null)])}});export{u as default};
